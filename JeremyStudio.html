<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8'/>
		<title>Candle Light FSM</title>

		<script src='Library/jquery-2.0.0.js'></script>
		<script src='Library/requestAnimFrame.js'></script>

		<script src='JeremyLibrary/JeremyAsset.js'></script>
		<script src='JeremyLibrary/JeremyCanvas.js'></script>
		<script src='JeremyLibrary/JeremyImage.js'></script>
		<script src='JeremyLibrary/JeremySprite.js'></script>
		<script src='JeremyLibrary/JeremyTimer.js'></script>
		<script src='JeremyLibrary/JeremyScene.js'></script>
		<script src='JeremyLibrary/JeremySceneContext.js'></script>
		<script src='JeremyLibrary/JeremyRenderable2D.js'></script>

		<script src='JeremyStudio/JeremyStudio.js'></script>
		<script src='JeremyStudio/AssetManager.js'></script>
		<script src='JeremyStudio/SceneManager.js'></script>
		<script src='JeremyStudio/EventManager.js'></script>
		<script src='JeremyStudio/DataManager.js'></script>
		<script src='JeremyStudio/LayerConfig.js'></script>
		<script src='JeremyStudio/Renderer2D.js'></script>

		<style>
			canvas {
				border: 1px solid black;
			}
		</style>
	</head>
	<body>
		<div id='GameArea'>

		</div>
		<script>
			function startGame() {
				JS('SceneManager').add(new JeremyScene('SplashScreenDigitalMedia', ['SplashScreenBrainstorm'], [], new JeremySceneContext(function init() {
					var srcSplashDigitalMedia = "Assets/Images/splash/MediaDept_splashscreen.png";
					JS('AssetManager').add(JS('AssetManager').make('splashDigitalMedia', srcSplashDigitalMedia, 'splashImage', 'splashDigitalMedia'));
					this.splashDigitalMedia = new JeremyRenderable2D('gui', function(ctx, argo) {
						ctx.drawImage(argo.img(), argo.posX, argo.posY);
					}, {
						img : function() {
							return JS('AssetManager').get('IMAGE', 'splashDigitalMedia').getImage();
						},
						posX : 0,
						posY : 0
					});
					this.angle = 0;
					JS('DataManager').set('splashAlphaAngle', this.angle);
					this.timer = new JeremyTimer(1, function(argo) {
						if (argo.timer.count > argo.duration) {
							JS('SceneManager').next();
						} else {
							var ctx = JS('Renderer2D').context('gui');
							ctx.globalAlpha = argo.getAlpha();
						}
					}, {
						duration : 240,
						getAlpha : function() {
							return Math.sin(JS('DataManager').get('splashAlphaAngle'));
						}
					});

					JS('Renderer2D').add(this.splashDigitalMedia);
				}, function update() {
					this.timer.update();
					JS('DataManager').set('splashAlphaAngle', this.angle += (Math.PI / 240));
				}, function destroy() {
					JS('Renderer2D').remove(this.splashDigitalMedia);
				})));

				JS('SceneManager').add(new JeremyScene('SplashScreenBrainstorm', ['SplashScreenCandleLight'], ['SplashScreenDigitalMedia'], new JeremySceneContext(function init() {
					var srcSplashBrainstorm = "Assets/Images/splash/Brainstorm_splashscreen.png";
					JS('AssetManager').add(JS('AssetManager').make('splashBrainstorm', srcSplashBrainstorm, 'splashImage', 'splashBrainstorm'));
					this.splashBrainstorm = new JeremyRenderable2D('gui', function(ctx, argo) {
						ctx.drawImage(argo.img(), argo.posX, argo.posY);
					}, {
						img : function() {
							return JS('AssetManager').get('IMAGE', 'splashBrainstorm').getImage();
						},
						posX : 0,
						posY : 0
					});

					this.angle = 0;
					JS('DataManager').set('splashAlphaAngle', this.angle);
					this.timer = new JeremyTimer(1, function(argo) {
						if (argo.timer.count > argo.duration) {
							JS('SceneManager').next();
						} else {
							var ctx = JS('Renderer2D').context('gui');
							ctx.globalAlpha = argo.getAlpha();
						}
					}, {
						duration : 240,
						getAlpha : function() {
							return Math.sin(JS('DataManager').get('splashAlphaAngle'));
						}
					});

					JS('Renderer2D').add(this.splashBrainstorm);
				}, function update() {
					this.timer.update();
					JS('DataManager').set('splashAlphaAngle', this.angle += (Math.PI / 240));
				}, function destroy() {
					JS('Renderer2D').remove(this.splashBrainstorm);
				})));

				JS('SceneManager').add(new JeremyScene('SplashScreenCandleLight', ['SplashScreenDigitalMedia'], ['SplashScreenBrainstorm'], new JeremySceneContext(function init() {
					var srcSplashCandleLight = "Assets/Images/splash/Candlelight_splashscreen1.png";
					JS('AssetManager').add(JS('AssetManager').make('splashCandleLight', srcSplashCandleLight, 'splashImage', 'splashCandleLight'));
					this.splashCandleLight = new JeremyRenderable2D('gui', function(ctx, argo) {
						ctx.drawImage(argo.img(), argo.posX, argo.posY);
					}, {
						img : function() {
							return JS('AssetManager').get('IMAGE', 'splashCandleLight').getImage();
						},
						posX : 0,
						posY : 0
					});

					this.angle = 0;
					JS('DataManager').set('splashAlphaAngle', this.angle);
					this.timer = new JeremyTimer(1, function(argo) {
						if (argo.timer.count > argo.duration) {
							JS('SceneManager').next();
						} else {
							var ctx = JS('Renderer2D').context('gui');
							ctx.globalAlpha = argo.getAlpha();
						}
					}, {
						duration : 240,
						getAlpha : function() {
							return Math.sin(JS('DataManager').get('splashAlphaAngle'));
						}
					});

					JS('Renderer2D').add(this.splashCandleLight);
				}, function update() {
					this.timer.update();
					JS('DataManager').set('splashAlphaAngle', this.angle += (Math.PI / 240));
				}, function destroy() {
					JS('Renderer2D').remove(this.splashCandleLight);
				})));

				JS('SceneManager').play('SplashScreenDigitalMedia');
			}

		</script>
	</body>
</html>